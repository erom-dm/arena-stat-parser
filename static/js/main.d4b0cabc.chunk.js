(this["webpackJsonparena-data-parser"]=this["webpackJsonparena-data-parser"]||[]).push([[0],{205:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),c=t(17),o=t.n(c),s=(t(77),t(78),t(79),t(5)),i=t(6);var l=t(72),u=t(2),m="instanceData";function d(e,a){localStorage.setItem(e,JSON.stringify(a))}var f,p=t(4),b="!disconnected",h="~DC~",v=(f={},Object(p.a)(f,572,"Ruins of Lordaeron"),Object(p.a)(f,562,"Blade's Edge Arena"),Object(p.a)(f,559,"Nagrand Arena"),f),j=["player1","player2","player3","player4","player5"],O=["Team comps","Rating change"];function g(e){var a=[];return e.forEach((function(e){var t,n,r={enteredTime:e.enteredTime,instanceID:e.instanceID,instanceName:e.instanceName,playerName:e.playerName,enemyTeamComp:[],myTeamComp:[],myTeamName:"",bracket:0,myTeam:{},enemyTeam:{},win:!1},c=function(e){var a,t,n,r,c=e.playerName;e.goldTeam.hasOwnProperty(c)?(a=e.goldTeam,r=e.goldTeam[c].teamName,t=e.purpleTeam,n=!!e.winningFaction):(a=e.purpleTeam,r=e.purpleTeam[c].teamName,t=e.goldTeam,n=!e.winningFaction);var o=Object.keys(a),s=Object.keys(t),i=o.length,l=s.length,u=Math.max(i,l);!function(e,a,t){if(e.length<t)for(var n=0;n<t-e.length;n++)e.push(h);if(a.length<t)for(var r=0;r<t-a.length;r++)a.push(h)}(o,s,u);var m={},d=[],f={},p=[];return o.forEach((function(e,t){return S(e,t,a,m,d)})),s.forEach((function(e,a){return S(e,a,t,f,p)})),{bracket:u,win:n,myTeamName:r,myTeam:m,myTeamComp:d.sort(),enemyTeam:f,enemyTeamComp:p.sort()}}(e);Object.assign(r,c),0===(null===(t=r.myTeam.player1)||void 0===t?void 0:t.teamMMR)&&0===(null===(n=r.enemyTeam.player1)||void 0===n?void 0:n.teamMMR)||a.push(r)})),a}function y(e){var a=[];return e.forEach((function(e){a.push.apply(a,Object(u.a)(e))})),a}function S(e,a,t,n,r){var c=e===h;n[j[a]]=c?null:Object(i.a)({name:e},t[e]),r.push(c?b:t[e].class)}function x(e){var a=[];return e.forEach((function(e){!function(e,a){for(var t=a.enteredTime,n=a.enemyTeamComp,r=a.myTeam,c=a.bracket,o=a.win,s=-1,i=-1,l=0;l<c;l++){var u=r[j[l]];u&&(s=u.newTeamRating,i=u.teamMMR)}var m={timestamp:t,newTeamRating:s,teamMMR:i,win:o,enemyTeamComp:w(n)};e.push(m)}(a,e)})),a}function T(e,a,t){var n="DC"===a,r=t.instanceID,c=t.myTeam,o=t.win,s=t.bracket,i={};if(!n)for(var l=0;l<s;l++){var u=c[j[l]];u?i[u.name]={healing:u.healing,damage:u.damage}:i.DC={healing:0,damage:0}}var m,d,f=e[a];f?(f.matchCount+=1,o&&f.wins++,f.zoneStats[r]?(f.zoneStats[r].matches++,o&&f.zoneStats[r].wins++):f.zoneStats[r]={matches:1,wins:Number(o)},!n&&(m=f.performanceStats,d=i,Object.keys(m).forEach((function(e){m[e].healing+=d[e].healing,m[e].damage+=d[e].damage})))):e[a]={matchCount:1,wins:Number(o),performanceStats:i,zoneStats:Object(p.a)({},r,{matches:1,wins:Number(o)})}}function w(e){return e.reduce((function(e,a){return e.concat(" \\ ",a)}))}var C=t(1),N=function(e){var a=e.localStoreChangeHandler,t=e.localStorageChangeValue,r=Object(n.useState)("Upload file here"),c=Object(s.a)(r,2),o=c[0],f=c[1],p=Object(n.useCallback)((function(e){e.forEach((function(n){console.dir(e);var r=new FileReader;r.onabort=function(){return f("File reading was aborted")},r.onerror=function(){return f("File reading failed")},r.onload=function(){var e,n,c=r.result;!function(e){var a=window.localStorage.getItem(m);if(a){var t=JSON.parse(a),n=[].concat(Object(u.a)(t),Object(u.a)(e)),r=Object(u.a)(new Map(n.map((function(e){return[e.enteredTime,e]}))).values());d(m,r)}else d(m,e)}((e=function(e){var a=e.lastIndexOf('["instances"] = ')+17,t=e.slice(a),n=new RegExp(/, -- \[\d+\]/,"g"),r=t.replaceAll("\n","").replaceAll("\r","").replaceAll("\t","").replaceAll('["','"').replaceAll('"]','"').replaceAll(" = ",":").replaceAll(",}","}").split(n),c=[];return r.forEach((function(e,a){try{c.push(JSON.parse(e))}catch(t){}})),c}((n=c,null===n||"string"===typeof n?'{"error":true}':(new TextDecoder).decode(new Uint8Array(n)))),e.filter((function(e){return Object.keys(v).includes(String(e.instanceID))&&e.hasOwnProperty("purpleTeam")&&e.hasOwnProperty("goldTeam")})))),a(!t),f("File successfully parsed")},r.readAsArrayBuffer(n)}))}),[a,t]),b=Object(l.a)({onDrop:p}),h=b.getRootProps,j=b.getInputProps;return Object(C.jsxs)("div",Object(i.a)(Object(i.a)({},h()),{},{className:"upload-area",children:[Object(C.jsx)("input",Object(i.a)({},j())),Object(C.jsx)("p",{children:o})]}))},k=t(15),E=t.n(k),R=t(69),A=t.n(R);E.a.extend(A.a);var M=t(28),D=function(e){var a=e.sessionData,t=e.onChange,r={value:0,label:"All Data"},c=Object(n.useState)([]),o=Object(s.a)(c,2),i=o[0],l=o[1],m=Object(n.useRef)(i);m.current=i,Object(n.useEffect)((function(){if(i.length){var e=!0,t=Object(u.a)(a.keys());i.map((function(e){return e.value})).forEach((function(a){t.includes(a)||(e=!1)})),e||l([])}}),[i,a]);var d=Object(u.a)(a.keys()),f=[];d.forEach((function(e,a){var t=E.a.unix(e).format("HH:mm - DD/MM/YY"),n={value:e,label:"Session ".concat(a+1,", @ ").concat(t)};f.push(n)})),f.reverse();var p=function(){var e;return(null===m||void 0===m||null===(e=m.current)||void 0===e?void 0:e.length)===f.length};return Object(C.jsx)(M.a,{className:"session-select",classNamePrefix:"session-select",defaultValue:r,isOptionSelected:function(e){var a;return(null===m||void 0===m||null===(a=m.current)||void 0===a?void 0:a.some((function(a){return a.value===e.value})))||p()},options:[r].concat(f),value:p()?[r]:i,onChange:function(e,a){var n=[],c=a.action,o=a.option,s=a.removedValue;if("select-option"===c&&(null===o||void 0===o?void 0:o.value)===r.value)l(f),n.push.apply(n,Object(u.a)(f.map((function(e){return e.value}))));else if("deselect-option"===c&&(null===o||void 0===o?void 0:o.value)===r.value||"remove-value"===c&&(null===s||void 0===s?void 0:s.value)===r.value)l([]);else if("deselect-option"===a.action&&p()){var i=f.filter((function(e){return e.value!==(null===o||void 0===o?void 0:o.value)}));l(i),n.push.apply(n,Object(u.a)(i.map((function(e){return e.value}))))}else l(e||[]),n.push.apply(n,Object(u.a)(e.map((function(e){return e.value}))));t&&t(n)},hideSelectedOptions:!1,closeMenuOnSelect:!1,isMulti:!0})};var F=function(e){var a=e.teams,t=e.onChange,r=Object(n.useState)(),c=Object(s.a)(r,2),o=c[0],i=c[1],l=a.map((function(e){return{value:e,label:e}})),u=function(e){i(e),t&&e&&t(e.value)};return Object(n.useEffect)((function(){l.length&&!o&&i(l[0]),u(l[0])}),[a]),Object(C.jsx)(M.a,{className:"team-select",classNamePrefix:"team-select",options:l,value:o,onChange:u})},z=function(e){var a=e.buttonLabels,t=e.selected,n=e.onChange,r=a.map((function(e,a){var r=e===t;return Object(C.jsx)("button",{name:e,className:"button-group__button".concat(r?" button-group__button--selected":""),onClick:function(a){return function(e,a){n&&n(a)}(0,e)},children:e},a)}));return Object(C.jsx)("div",{className:"button-group",children:r})},I=t(29),L=t(207);function P(e,a,t){var n=t.colorStart,r=t.colorEnd;return t.useEndAsStart?r-e*a:n+e*a}function _(e,a){return(a/e*100).toFixed(1)}var J=function(e){var a,t,n=e.dataset,r=0,c=0,o=[],s=[],i=[],l=[],u=[],m=[],d={color:"#292F36",font:{size:15,family:"'Roboto', sans-serif"},stepSize:1,beginAtZero:!0},f={maintainAspectRatio:!1,indexAxis:"y",responsive:!0,scales:{y:{ticks:d},x:{ticks:d}},plugins:{tooltip:{callbacks:{afterLabel:function(e){var a=e.dataIndex,t=e.dataset.wins[a],n=e.dataset.data[a],r=e.dataset.zoneStats[a],c=e.dataset.performanceStats[a],o=_(n,t),s=[];Object.keys(r).forEach((function(e){s.push("".concat(v[Number(e)],": ").concat(_(r[e].matches,r[e].wins),"%"))}));var i=[];return Object.keys(c).forEach((function(e){var a=+(c[e].damage/n).toFixed(0),t=+(c[e].healing/n).toFixed(0).toLocaleString();i.push("".concat(e,": damage: ").concat(a.toLocaleString()," | healing: ").concat(t.toLocaleString()))})),["Wins: ".concat(t,", Losses: ").concat(n-t),"WR: ".concat(o,"%")," ","Zone win rates:"].concat(s,[" ","Average performance stats:"],i)}}},legend:{display:!1}}},p={labels:o,datasets:[{label:"",data:s,wins:i,zoneStats:l,performanceStats:u,backgroundColor:m,borderColor:[],borderWidth:1,hoverOffset:6}]},b=[];Object.keys(n).forEach((function(e){var a=n[e],t=a.matchCount,r=a.wins,c=a.zoneStats,o=a.performanceStats;b.push({teamComp:e,matchCount:t,wins:r,zoneStats:c,performanceStats:o})})),b.sort((function(e,a){return a.matchCount-e.matchCount})),b.forEach((function(e){var a=e.matchCount,t=e.wins,n=e.zoneStats,m=e.performanceStats,d=e.teamComp;r+=a,c+=t,o.push([d]),s.push(a),i.push(t),l.push(n),u.push(m)})),function(e,a,t,n){var r,c,o=t.colorStart,s=(t.colorEnd-o)/e;for(r=0;r<e;r++)c=P(r,s,t),n.push(a(c))}(b.length,L.a,{colorStart:.1,colorEnd:.85,useEndAsStart:!0},m),a=r-c,t=_(r,c);var h="Matches Played: ".concat(r,", Wins: ").concat(c,", Losses: ").concat(a,", WR: ").concat(t,"%,");return Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)("div",{className:"header",children:Object(C.jsx)("h1",{className:"title",children:h})}),Object(C.jsx)("div",{className:"chart-container",children:Object(C.jsx)(I.a,{data:p,options:f})})]})},W=function(e){var a=e.dataset,t=[],n=[],r=[],c=[],o=[];a.sort((function(e,a){return e.timestamp-a.timestamp})),a.forEach((function(e,s){var i,l=e.enemyTeamComp,u=e.newTeamRating,m=e.win;t.push(u),r.push(l),c.push(String(s+1)),o.push(m);var d=null===(i=a[s+1])||void 0===i?void 0:i.teamMMR;d&&n.push(d)}));var s={color:"#292F36",font:{size:15,family:"'Roboto', sans-serif"},stepSize:1,beginAtZero:!0},l={maintainAspectRatio:!1,scales:{"y-axis-1":{ticks:Object(i.a)(Object(i.a)({},s),{},{autoSkip:!0,maxTicksLimit:15}),bounds:"ticks",grid:{borderDashOffset:.9}},x:{ticks:Object(i.a)(Object(i.a)({},s),{},{autoSkip:!0,maxTicksLimit:20})}},plugins:{tooltip:{callbacks:{afterLabel:function(e){var a=e.dataIndex,t=e.dataset.enemyComp[a],n=e.dataset.win[a];return[t,"".concat(n?"Win":"Loss")]}}}}},u={labels:c,datasets:[{label:"New Team Rating",data:t,enemyComp:r,win:o,fill:!1,backgroundColor:"rgb(254,38,0)",borderColor:"rgb(254,131,0)",yAxisID:"y-axis-1"},{label:"MMR",data:n,enemyComp:r,win:o,fill:!1,backgroundColor:"rgb(0,196,255)",borderColor:"rgb(0,255,255)",yAxisID:"y-axis-1"}]};return Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)("div",{className:"header",children:Object(C.jsx)("h1",{className:"title",children:"Team Rating Change"})}),Object(C.jsx)("div",{className:"chart-container",children:Object(C.jsx)(I.b,{data:u,options:l})})]})},B=function(e){var a=e.sessionData,t=e.sessionSelection,r=e.chartType,c=Object(n.useState)({}),o=Object(s.a)(c,2),i=o[0],l=o[1],m=Object(n.useState)(""),d=Object(s.a)(m,2),f=d[0],p=d[1];return Object(n.useEffect)((function(){var e=[];if(null===a||void 0===a?void 0:a.size)if(t.includes(0))e.push.apply(e,Object(u.a)(y(a)));else{var n=new Map;t.forEach((function(e){var t=a.get(e);t&&n.set(e,t)})),e.push.apply(e,Object(u.a)(y(n)))}switch(r){case O[0]:l(function(e){var a={};return e.forEach((function(e){if(e.enemyTeamComp.includes(b)||e.myTeamComp.includes(b))T(a,"DC",e);else{var t=w(e.enemyTeamComp);T(a,t,e)}})),a}(e));break;case O[1]:l(x(e))}p(r)}),[r,a,t]),Object(C.jsxs)("div",{className:"chart-wrapper",children:["Team comps"===f&&Object(C.jsx)(J,{dataset:i}),"Rating change"===f&&Object(C.jsx)(W,{dataset:i})]})},H=function(){var e=Object(n.useState)([]),a=Object(s.a)(e,2),t=a[0],r=a[1],c=Object(n.useState)([""]),o=Object(s.a)(c,2),i=o[0],l=o[1],d=Object(n.useState)(""),f=Object(s.a)(d,2),p=f[0],b=f[1],h=Object(n.useState)(new Map),v=Object(s.a)(h,2),j=v[0],y=v[1],S=Object(n.useState)([0]),x=Object(s.a)(S,2),T=x[0],w=x[1],k=Object(n.useState)("Team comps"),R=Object(s.a)(k,2),A=R[0],M=R[1],I=Object(n.useState)(!1),L=Object(s.a)(I,2),P=L[0],_=L[1];return Object(n.useEffect)((function(){var e,a=window.localStorage.getItem(m);if(a){var t=g(JSON.parse(a));r(t),l((e=t,Object(u.a)(new Set(e.map((function(e){return e.myTeamName}))))))}}),[P]),Object(n.useEffect)((function(){var e,a=(e=p,t.filter((function(a){return a.myTeamName===e})));y(function(e){var a=new Map;e.sort((function(e,a){return e.enteredTime-a.enteredTime}));var t,n=null;return e.every((function(e){if(n){var r,c=E.a.unix(t.enteredTime);if(E.a.unix(e.enteredTime).isBetween(c,c.add(1,"hour")))return null===(r=a.get(n))||void 0===r||r.push(e),t=e,!0}return n=e.enteredTime,t=e,a.set(n,[e]),!0})),a}(a)),w([0])}),[t,p]),Object(C.jsxs)("div",{className:"dashboard",children:[Object(C.jsxs)("div",{className:"dashboard__top-bar",children:[Object(C.jsx)(N,{localStoreChangeHandler:_,localStorageChangeValue:P}),Object(C.jsxs)("div",{className:"dashboard__filters",children:[Object(C.jsx)(z,{onChange:M,buttonLabels:O,selected:A}),i&&Object(C.jsx)(F,{onChange:b,teams:i}),j&&Object(C.jsx)(D,{onChange:w,sessionData:j})]})]}),t&&Object(C.jsx)(B,{sessionData:j,sessionSelection:T,chartType:A})]})};var V=function(){return Object(C.jsx)("div",{className:"main-wrap",children:Object(C.jsx)(H,{})})},Z=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,208)).then((function(a){var t=a.getCLS,n=a.getFID,r=a.getFCP,c=a.getLCP,o=a.getTTFB;t(e),n(e),r(e),c(e),o(e)}))};o.a.render(Object(C.jsx)(r.a.StrictMode,{children:Object(C.jsx)(V,{})}),document.getElementById("root")),Z()},78:function(e,a,t){},79:function(e,a,t){}},[[205,1,2]]]);
//# sourceMappingURL=main.d4b0cabc.chunk.js.map