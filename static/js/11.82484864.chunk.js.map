{"version":3,"sources":["components/TeamList.tsx","assets/swords.png","assets/heal.png","components/MatchItem.tsx","../../src/useIntersectionObserver.ts","../../src/useTrackVisibility.ts","../../src/useInfiniteScroll.ts","components/MatchList.tsx"],"names":["TeamList","className","team","playerArr","Object","values","sort","a","b","nameA","name","toLowerCase","nameB","map","player","nameAndRealm","playerClass","class","damage","healing","split","Fragment","src","alt","toLocaleString","MatchItem","match","enteredTime","instanceID","enemyTeamName","myTeamName","win","myTeam","enemyTeam","getTeamRatingValues","myMMR","MMR","myRating","rating","myRatingChange","ratingChange","enemyMMR","enemyRating","enemyRatingChange","enemyTeamRealm","date","dayjs","unix","format","myRatingChangeString","Math","abs","enemyRatingChangeString","DEFAULT_THRESHOLD","useTrackVisibility","rootMargin","args","threshold","nodeRef","useRef","rootRef","observerRef","useState","entry","setEntry","unobserve","useCallback","currentObserver","useEffect","observe","node","root","observer","IntersectionObserver","newEntry","initializeObserver","useIntersectionObserver","ref","result","isVisible","Boolean","wasEverVisible","setWasEverVisible","loading","hasNextPage","onLoadMore","disabled","delayInMs","DEFAULT_DELAY_IN_MS","shouldLoadMore","timer","setTimeout","clearTimeout","MatchList","selectedArenaMatches","step","setStep","setLoading","matchItems","useMemo","slicedItems","slice","hasMore","length","useInfiniteScroll","sentryRef"],"mappings":"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","file":"static/js/11.82484864.chunk.js","sourcesContent":["import React from \"react\";\nimport { ModdedArenaTeam } from \"../Types/ArenaTypes\";\nimport DpsIcon from \"../assets/swords.png\";\nimport HealingIcon from \"../assets/heal.png\";\n\nexport type teamListProps = {\n  team: ModdedArenaTeam;\n  className?: string;\n};\n\nconst TeamList: React.FC<teamListProps> = ({ className, team }) => {\n  const playerArr = Object.values(team)\n    .sort((a, b) => {\n      if (a && b) {\n        const nameA = a.name.toLowerCase();\n        const nameB = b.name.toLowerCase();\n        if (nameA < nameB) {\n          return -1;\n        }\n        if (nameA > nameB) {\n          return 1;\n        }\n      }\n      return 1;\n    })\n    .map((player) => {\n      if (player) {\n        const {\n          name: nameAndRealm,\n          class: playerClass,\n          damage,\n          healing,\n        } = player;\n        const name = nameAndRealm.split(\"-\")[0];\n\n        return (\n          <React.Fragment key={name + damage}>\n            <div\n              className={`team-list__player-name ${playerClass.toLowerCase()}`}\n            >{`${name}: `}</div>\n            <div>\n              <img className=\"team-list__dps-icon\" src={DpsIcon} alt=\"dps\" />\n              <span>{damage.toLocaleString() + \" \"}</span>\n            </div>\n            <div>\n              <img\n                className=\"team-list__heal-icon\"\n                src={HealingIcon}\n                alt=\"heal\"\n              />\n              <span>{healing.toLocaleString()}</span>\n            </div>\n          </React.Fragment>\n        );\n      }\n      return null;\n    });\n\n  return <div className={className}>{playerArr}</div>;\n};\n\nexport default TeamList;\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAdgAAAHYBTnsmCAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAANeSURBVDiNjZJtTFN3GMUPLQ4JUGwpSAp9GbVFXlrASkWDEzVGpBRi8AWtwFyGJMbEJWbLkmXGbVm2xZltH7ZkMdmHmeg2RZghazZFMu0sLRcBC9y+gLes1LaALb0ttELrfx+2mGWb287n55f8npyTUlWtDak2bSLzAb/V2NtrAPAY/x6hSlN9XiyTatwMI8ahIwabO7RIbtsmieHVzqhavbn8uaRQVKw7cND509g4ueP2kOaXjy9wZphpM3dlBZVFMrzxzrsZpRr1bQBZ/8BnVdZorpy98ImCn5MDZvYRgoE5CwDkGNra7QuRKJmLLJE7difRtxygAaz5E/yCZtu2/gHaQayzPtJHu0hjW3sEgOAPNaGyXtdocft8xM9GiZEaIfuam8cApALgVmi1fTcsVHLQ84hcHhohDUcM8zJFWeXfFF878/qXoeVY0sdGyI17g0S3f/+9mrqdxh6TOWH2eEn3hIN0nT139zkv/h6dXn+JemBLeMMsuf6zibR2nkj00S7yufHm06a2jrv/0RAAgKPdsvWyZWQ07g2z5PtfzOToia7E9oYGEwDOX4+5AFC2QaivKs39bHWFOxqOxpYkCuVJO/NQWq5UPt2oLObkSqUcm8Uad9KTX8nF/OLN5XlfZ6atCQeCy04AQK2m4CpLnSIKKf/Kjr31w/0TdnLLxZCjnV2JMbsj4WOjZGCcJi2GYwHli8JvWOoUeUlT8N0zg+iTxCA9FdwjLcxRHTr51gaRVAbG74fpR6PL2NMzqtc3ygvX5yFDkJ0R9w0X9N50TJtt/o5YLMFyASAWS7DLsVRe5tq0ncnQONi1otTuixfnbl2/VuZmmG9drqm9CrlMZOr+aNXNhJIP7OEvvIHQD88MikTrX9FtqXm7Ql4iGJ6gl+amh2I0RfWvy0qzCbLT+cH5mbIFxpz/q3uR7KrYzstMT69DCiK+x8FBjrokr10pKXivRlWSR894kvR06EPEF73UtdbDcgnvfJE462PqqqF1dSXun3QG33846wvs1lSl5q7jfdBUKzmdUqcVD9VrZaoB6xLmw+yb9x1TnwoE6eJSmeBCiH1yCQD4vLS2SXfwTDAY88hE+ceVhfnndm/NzLaOeVkAELbUSWebaiWn/89IAEC9MbdjR7WYAiD8DbsDj4XA/xpXAAAAAElFTkSuQmCC\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAdgAAAHYBTnsmCAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAK6SURBVDiNdZNrSFNhGMd/O8dsbkd3VptJOi3SLjYqotKQsqQkIqKIsqyoiKKgoj5E0OVTKITRh4IuhNJFojATiS5kEl3oAtVKnZEtqZVZOvIcz5y6zbM+hLJp/b897/t//vye9+EV+b/iMpOSNo4xmWb87utrBvR/mQzDatFmNC6cJMvbpsjyrJ3Z2VMiwHm3u8Wjqq7PilLh6+t7Eh1mAJhjt5c7EhMzkxMSUpZnZKQWpqebjaIYk9wbDnPf6w3c93q/dwQCv777/Z9ed3ZuNwCcy89373I6s6MbXnT6eOb3A7DAbCY32R4TuO/p0y9nGhomxgFEIpGhC6W/nwMeD3OLiiksXAbAy/o6KqurKEl3YImPj30ogA+KYho8OOL9xp4LFVhkmatlJwDYfPAQcxcVcHTvbs5kTooJEIZjz1xbhEWWARh472LgvQuAJIuF6avX8KrTN5JgUE80jWUFSygvPU6o4R2rUlIAOL9+DaNmzKJo734e1NaQY7fFEuiRSBjAELVUOcFEnCAQJwjICX8n1HUdUfhrGtD10BCBFgwqAAvNEi/r69h++BgAlzatB2Br5XUAHtZUs0CSAPCHQuoQwWdNa9JCIXKT7TRWV6EqCgC9WZPpzZoMQLeq4mxvY57NRncwSKuqNgKIAD5Ne2sQhHWLU1OT8iSJkiuX6TEYWLFpCzPn5/H4zm3qTpWxQRQwiiKlb9603Wxp2RiGbhEgDN1dwaAwQZJynGPHGlfa7USa3TyqvUXrvTvktrexw5GGURS5+/WrdrG5uczb03NviADgVyDw/KOqjlb6+6fmjBsnpUtm8qxW8qxW0kwmwrrOSZfr59mmptOvOzpKB/uGfybGm0yzp1mtJ5Y6HM51WVkpEeCGx9Ne7/W6P3R1HfoRCLyN9o8IiFKq02YrBmjy+a4Bbf8y/QGaXAStAg1h/gAAAABJRU5ErkJggg==\"","import React from \"react\";\nimport { ModdedArenaMatch } from \"../Types/ArenaTypes\";\nimport dayjs from \"dayjs\";\nimport { getTeamRatingValues } from \"../utils/dataSetHelpers\";\nimport TeamList from \"./TeamList\";\n\nexport type matchItemProps = {\n  match: ModdedArenaMatch;\n};\n\nconst MatchItem: React.FC<matchItemProps> = ({ match }) => {\n  const {\n    enteredTime,\n    instanceID,\n    enemyTeamName,\n    myTeamName,\n    win,\n    myTeam,\n    enemyTeam,\n  } = match;\n  const {\n    MMR: myMMR,\n    rating: myRating,\n    ratingChange: myRatingChange,\n  } = getTeamRatingValues(myTeam);\n  const {\n    MMR: enemyMMR,\n    rating: enemyRating,\n    ratingChange: enemyRatingChange,\n  } = getTeamRatingValues(enemyTeam);\n  const enemyTeamRealm = Object.values(enemyTeam)[0]?.name.split(\"-\")[1];\n\n  const date = dayjs.unix(enteredTime).format(\"DD/MM/YY HH:mm\");\n  const myRatingChangeString =\n    myRatingChange >= 0\n      ? ` (+${myRatingChange})`\n      : ` (-${Math.abs(myRatingChange)})`;\n  const enemyRatingChangeString =\n    enemyRatingChange >= 0\n      ? ` (+${enemyRatingChange})`\n      : ` (-${Math.abs(enemyRatingChange)})`;\n\n  return (\n    <div className={`match-item instance-${instanceID}`} key={enteredTime}>\n      <div className=\"match-item__team-wrapper\">\n        <div className={`match-item__team team-left ${win ? \"win\" : \"loss\"}`}>\n          <div className=\"match-item__team-header\">\n            <div className=\"match-item__team-name\">{myTeamName}</div>\n            <div className=\"match-item__team-rating\">\n              <span>{`TR: ${myRating}`}</span>\n              <span\n                className={`match-item__rating-change ${win ? \"win\" : \"loss\"}`}\n              >\n                {myRatingChangeString}\n              </span>\n              <span className=\"match-item__mmr-span\">{`MMR: ${myMMR}`}</span>\n            </div>\n          </div>\n          <TeamList team={myTeam} className={\"team-list team-list--my-team\"} />\n        </div>\n        <div className={`match-item__team team-right`}>\n          <div className=\"match-item__team-header\">\n            <div className=\"match-item__team-name\">{enemyTeamName}</div>\n            <div className=\"match-item__team-rating\">\n              <span>{`TR: ${enemyRating}`}</span>\n              <span\n                className={`match-item__rating-change ${!win ? \"win\" : \"loss\"}`}\n              >\n                {enemyRatingChangeString}\n              </span>\n              <span className=\"match-item__mmr-span\">{` MMR: ${enemyMMR}`}</span>\n            </div>\n          </div>\n          <TeamList\n            team={enemyTeam}\n            className={\"team-list team-list--enemy-team\"}\n          />\n        </div>\n      </div>\n      <div className=\"match-item__footer\">\n        <div className=\"match-item__date\">{date}</div>\n        <div className=\"match-item__enemy-team-realm\">{enemyTeamRealm}</div>\n      </div>\n    </div>\n  );\n};\n\nexport default MatchItem;\n","import { useState, useCallback, useEffect, useRef } from 'react';\r\n\r\nconst DEFAULT_ROOT_MARGIN = '0px';\r\nconst DEFAULT_THRESHOLD = [0];\r\n\r\n// eslint-disable-next-line no-undef\r\nexport type IntersectionObserverHookArgs = IntersectionObserverInit;\r\n\r\nexport type IntersectionObserverHookRefCallbackNode = Element | null;\r\n\r\nexport type IntersectionObserverHookRefCallback = (\r\n  node: IntersectionObserverHookRefCallbackNode,\r\n) => void;\r\n\r\nexport type IntersectionObserverHookRootRefCallbackNode = IntersectionObserverHookArgs['root'];\r\n\r\nexport type IntersectionObserverHookRootRefCallback = (\r\n  node: IntersectionObserverHookRootRefCallbackNode,\r\n) => void;\r\n\r\nexport type IntersectionObserverHookResult = [\r\n  IntersectionObserverHookRefCallback,\r\n  {\r\n    entry: IntersectionObserverEntry | undefined;\r\n    rootRef: IntersectionObserverHookRootRefCallback;\r\n  },\r\n];\r\n\r\n// For more info:\r\n// https://developers.google.com/web/updates/2016/04/intersectionobserver\r\n// https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API\r\nfunction useIntersectionObserver(\r\n  args?: IntersectionObserverHookArgs,\r\n): IntersectionObserverHookResult {\r\n  const rootMargin = args?.rootMargin ?? DEFAULT_ROOT_MARGIN;\r\n  const threshold = args?.threshold ?? DEFAULT_THRESHOLD;\r\n\r\n  const nodeRef = useRef<IntersectionObserverHookRefCallbackNode>(null);\r\n  const rootRef = useRef<IntersectionObserverHookRootRefCallbackNode>(null);\r\n  const observerRef = useRef<IntersectionObserver | null>(null);\r\n\r\n  const [entry, setEntry] = useState<IntersectionObserverEntry>();\r\n\r\n  const unobserve = useCallback(() => {\r\n    // Disconnect the current observer (if there is one)\r\n    const currentObserver = observerRef.current;\r\n    currentObserver?.disconnect();\r\n    observerRef.current = null;\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    return () => {\r\n      // We disconnect the observer on unmount to prevent memory leaks etc.\r\n      unobserve();\r\n    };\r\n  }, [unobserve]);\r\n\r\n  const observe = useCallback(() => {\r\n    const node = nodeRef.current;\r\n    if (node) {\r\n      const root = rootRef.current;\r\n      const options = { root, rootMargin, threshold };\r\n      // Create a observer for current \"node\" with given options.\r\n      const observer = new IntersectionObserver(([newEntry]) => {\r\n        setEntry(newEntry);\r\n      }, options);\r\n      observer.observe(node);\r\n      observerRef.current = observer;\r\n    }\r\n  }, [rootMargin, threshold]);\r\n\r\n  const initializeObserver = useCallback(() => {\r\n    unobserve();\r\n    observe();\r\n  }, [observe, unobserve]);\r\n\r\n  const refCallback = useCallback<IntersectionObserverHookRefCallback>(\r\n    (node) => {\r\n      nodeRef.current = node;\r\n      initializeObserver();\r\n    },\r\n    [initializeObserver],\r\n  );\r\n\r\n  const rootRefCallback = useCallback<IntersectionObserverHookRootRefCallback>(\r\n    (rootNode) => {\r\n      rootRef.current = rootNode;\r\n      initializeObserver();\r\n    },\r\n    [initializeObserver],\r\n  );\r\n\r\n  return [refCallback, { entry, rootRef: rootRefCallback }];\r\n}\r\n\r\nexport default useIntersectionObserver;\r\n","import { useEffect, useState } from 'react';\r\nimport useIntersectionObserver, {\r\n  IntersectionObserverHookArgs,\r\n  IntersectionObserverHookResult,\r\n} from './useIntersectionObserver';\r\n\r\nexport type TrackVisibilityHookArgs = IntersectionObserverHookArgs;\r\n\r\nexport type TrackVisibilityHookResult = [\r\n  IntersectionObserverHookResult[0],\r\n  IntersectionObserverHookResult[1] & {\r\n    isVisible: boolean;\r\n    wasEverVisible: boolean;\r\n  },\r\n];\r\n\r\nfunction useTrackVisibility(\r\n  args?: IntersectionObserverHookArgs,\r\n): TrackVisibilityHookResult {\r\n  const [ref, result] = useIntersectionObserver(args);\r\n  const isVisible = Boolean(result.entry?.isIntersecting);\r\n  const [wasEverVisible, setWasEverVisible] = useState(isVisible);\r\n\r\n  useEffect(() => {\r\n    if (isVisible) {\r\n      setWasEverVisible(isVisible);\r\n    }\r\n  }, [isVisible]);\r\n\r\n  return [ref, { ...result, isVisible, wasEverVisible }];\r\n}\r\n\r\nexport default useTrackVisibility;\r\n","import { useEffect } from 'react';\r\nimport {\r\n  useTrackVisibility,\r\n  IntersectionObserverHookArgs,\r\n  IntersectionObserverHookRefCallback,\r\n  IntersectionObserverHookRootRefCallback,\r\n} from 'react-intersection-observer-hook';\r\n\r\nconst DEFAULT_DELAY_IN_MS = 100;\r\n\r\nexport type UseInfiniteScrollHookResult = [\r\n  IntersectionObserverHookRefCallback,\r\n  { rootRef: IntersectionObserverHookRootRefCallback },\r\n];\r\n\r\nexport type UseInfiniteScrollHookArgs = Pick<\r\n  IntersectionObserverHookArgs,\r\n  // We pass this to 'IntersectionObserver'. We can use it to configure when to trigger 'onLoadMore'.\r\n  'rootMargin'\r\n> & {\r\n  // Some sort of \"is fetching\" info of the request.\r\n  loading: boolean;\r\n  // If the list has more items to load.\r\n  hasNextPage: boolean;\r\n  // The callback function to execute when the 'onLoadMore' is triggered.\r\n  // eslint-disable-next-line no-undef\r\n  onLoadMore: VoidFunction;\r\n  // Flag to stop infinite scrolling. Can be used in case of an error etc too.\r\n  disabled?: boolean;\r\n  // How long it should wait before triggering 'onLoadMore'.\r\n  delayInMs?: number;\r\n};\r\n\r\nfunction useInfiniteScroll({\r\n  loading,\r\n  hasNextPage,\r\n  onLoadMore,\r\n  rootMargin,\r\n  disabled,\r\n  delayInMs = DEFAULT_DELAY_IN_MS,\r\n}: UseInfiniteScrollHookArgs): UseInfiniteScrollHookResult {\r\n  const [ref, { rootRef, isVisible }] = useTrackVisibility({\r\n    rootMargin,\r\n  });\r\n\r\n  const shouldLoadMore = !disabled && !loading && isVisible && hasNextPage;\r\n\r\n  // eslint-disable-next-line consistent-return\r\n  useEffect(() => {\r\n    if (shouldLoadMore) {\r\n      // When we trigger 'onLoadMore' and new items are added to the list,\r\n      // right before they become rendered on the screen, 'loading' becomes false\r\n      // and 'isVisible' can be true for a brief time, based on the scroll position.\r\n      // So, it triggers 'onLoadMore' just after the first one is finished.\r\n      // We use a small delay here to prevent this kind of situations.\r\n      // It can be configured by hook args.\r\n      const timer = setTimeout(() => {\r\n        onLoadMore();\r\n      }, delayInMs);\r\n      return () => {\r\n        clearTimeout(timer);\r\n      };\r\n    }\r\n  }, [onLoadMore, shouldLoadMore, delayInMs]);\r\n\r\n  return [ref, { rootRef }];\r\n}\r\n\r\nexport default useInfiniteScroll;\r\n","import React, { useMemo, useState } from \"react\";\r\nimport { ModdedArenaMatch } from \"../Types/ArenaTypes\";\r\nimport MatchItem from \"./MatchItem\";\r\nimport useInfiniteScroll from \"react-infinite-scroll-hook\";\r\n\r\nexport type matchListProps = {\r\n  selectedArenaMatches: ModdedArenaMatch[];\r\n};\r\n\r\nconst LIST_ITEMS_PER_STEP = 10;\r\n\r\nconst MatchList: React.FC<matchListProps> = ({ selectedArenaMatches }) => {\r\n  const [step, setStep] = useState(1);\r\n\r\n  const [loading, setLoading] = useState<boolean>(false);\r\n  const matchItems = useMemo(() => {\r\n    return selectedArenaMatches\r\n      .sort((a, b) => b.enteredTime - a.enteredTime)\r\n      .map((match) => <MatchItem match={match} key={match.enteredTime} />);\r\n  }, [selectedArenaMatches]);\r\n  const slicedItems = useMemo(\r\n    () => matchItems?.slice(0, LIST_ITEMS_PER_STEP * step),\r\n    [matchItems, step]\r\n  );\r\n\r\n  const loadMore = () => setStep(step + 1);\r\n  const hasMore = slicedItems?.length < matchItems?.length;\r\n\r\n  const [sentryRef] = useInfiniteScroll({\r\n    loading: loading,\r\n    hasNextPage: hasMore,\r\n    onLoadMore: () => {\r\n      setLoading(true);\r\n      loadMore();\r\n      setLoading(false);\r\n    },\r\n  });\r\n\r\n  return (\r\n    <div className=\"match-list\">\r\n      {slicedItems}\r\n      {(loading || hasMore) && <div ref={sentryRef}>Loading...</div>}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MatchList;\r\n"],"sourceRoot":""}