(this["webpackJsonparena-data-parser"]=this["webpackJsonparena-data-parser"]||[]).push([[0],{209:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),c=t(18),o=t.n(c),s=(t(81),t(82),t(83),t(5)),i=t(6);var m=t(75),l=t(2),u="instanceData";function d(e,a){localStorage.setItem(e,JSON.stringify(a))}var f,p=t(4),b="!disconnected",h="~DC~",v=(f={},Object(p.a)(f,572,"Ruins of Lordaeron"),Object(p.a)(f,562,"Blade's Edge Arena"),Object(p.a)(f,559,"Nagrand Arena"),f),j=["player1","player2","player3","player4","player5"],y=["Team comps","Rating change","Teams"];function g(e){var a=[];return e.forEach((function(e){var t,n,r={enteredTime:e.enteredTime,instanceID:e.instanceID,instanceName:e.instanceName,playerName:e.playerName,enemyTeamComp:[],enemyTeamName:"",enemyPlayerNames:[],enemyTeamRating:0,enemyTeamMMR:0,myTeamComp:[],myTeamName:"",bracket:0,myTeam:{},enemyTeam:{},win:!1},c=function(e){var a,t,n,r,c=e.playerName;e.goldTeam.hasOwnProperty(c)?(a=e.goldTeam,r=e.goldTeam[c].teamName,t=e.purpleTeam,n=!!e.winningFaction):(a=e.purpleTeam,r=e.purpleTeam[c].teamName,t=e.goldTeam,n=!e.winningFaction);var o=Object.keys(a),s=Object.keys(t),i=o.length,m=s.length,l=Math.max(i,m);!function(e,a,t){if(e.length<t)for(var n=0;n<t-e.length;n++)e.push(h);if(a.length<t)for(var r=0;r<t-a.length;r++)a.push(h)}(o,s,l);var u={},d=[],f={},p=[],b="",v=0,j=0,y=[];return o.forEach((function(e,t){return T(e,t,a,u,d)})),s.forEach((function(e,a){e!==h&&(b=t[e].teamName,v=t[e].teamMMR,j=t[e].teamRating,y.push(e)),T(e,a,t,f,p)})),{bracket:l,win:n,myTeamName:r,enemyTeamName:b,enemyPlayerNames:y,enemyTeamMMR:v,enemyTeamRating:j,myTeam:u,myTeamComp:d.sort(),enemyTeam:f,enemyTeamComp:p.sort()}}(e);Object.assign(r,c),0===(null===(t=r.myTeam.player1)||void 0===t?void 0:t.teamMMR)&&0===(null===(n=r.enemyTeam.player1)||void 0===n?void 0:n.teamMMR)||a.push(r)})),a}function O(e){var a=[];return e.forEach((function(e){a.push.apply(a,Object(l.a)(e))})),a}function T(e,a,t,n,r){var c=e===h;n[j[a]]=c?null:Object(i.a)({name:e},t[e]),r.push(c?b:t[e].class)}function x(e){var a=[];return e.forEach((function(e){!function(e,a){for(var t=a.enteredTime,n=a.enemyTeamComp,r=a.myTeam,c=a.bracket,o=a.win,s=-1,i=-1,m=0;m<c;m++){var l=r[j[m]];l&&(s=l.newTeamRating,i=l.teamMMR)}var u={timestamp:t,newTeamRating:s,teamMMR:i,win:o,enemyTeamComp:S(n)};e.push(u)}(a,e)})),a}function N(e,a,t){var n="DC"===a,r=t.instanceID,c=t.myTeam,o=t.win,s=t.bracket,i={};if(!n)for(var m=0;m<s;m++){var l=c[j[m]];l?i[l.name]={healing:l.healing,damage:l.damage}:i.DC={healing:0,damage:0}}var u,d,f=e[a];f?(f.matchCount+=1,o&&f.wins++,f.zoneStats[r]?(f.zoneStats[r].matches++,o&&f.zoneStats[r].wins++):f.zoneStats[r]={matches:1,wins:Number(o)},!n&&(u=f.performanceStats,d=i,Object.keys(u).forEach((function(e){u[e].healing+=d[e].healing,u[e].damage+=d[e].damage})))):e[a]={matchCount:1,wins:Number(o),performanceStats:i,zoneStats:Object(p.a)({},r,{matches:1,wins:Number(o)})}}function S(e){return e.reduce((function(e,a){return e.concat(" \\ ",a)}))}function C(e){var a={};return e.forEach((function(e){var t=e.win,n=function(e,a){var t=a.enemyTeamComp,n=a.enemyPlayerNames,r=a.enemyTeamMMR,c=a.enemyTeamName,o=a.enemyTeamRating;return{enemyTeamComp:S(t),teamName:c,enemyPlayerNames:n,enemyTeamMMR:r,enemyTeamRating:o}}(0,e);if(a[n.teamName]){var r=a[n.teamName],c={teamName:r.teamName,enemyTeamComp:r.enemyTeamComp,enemyPlayerNames:Array.from(new Set([].concat(Object(l.a)(r.enemyPlayerNames),Object(l.a)(n.enemyPlayerNames)))),teamMMR:w(n.enemyTeamMMR,r.teamMMR),teamRating:w(n.enemyTeamRating,r.teamRating),matchesPlayed:r.matchesPlayed+1,wins:r.wins+Number(t)};a[n.teamName]=c}else{var o=w(n.enemyTeamMMR),s=w(n.enemyTeamRating),i={teamName:n.teamName,enemyTeamComp:n.enemyTeamComp,enemyPlayerNames:n.enemyPlayerNames,teamMMR:o,teamRating:s,matchesPlayed:1,wins:Number(t)};a[n.teamName]=i}})),a}function w(e,a){var t={min:0,max:0,average:0,total:0,matchCount:0};return a?(t.matchCount=a.matchCount+1,t.min=Math.min(a.min,e),t.max=Math.max(a.max,e),t.average=Number((e/t.matchCount+a.total/t.matchCount).toFixed(0)),t.total=a.total+e):(t.min=e,t.average=e,t.max=e,t.total=e,t.matchCount=1),t}function R(e,a){return(a/e*100).toFixed(1)}var M=t(1),k=function(e){var a=e.localStoreChangeHandler,t=e.localStorageChangeValue,r=Object(n.useState)("Upload file here"),c=Object(s.a)(r,2),o=c[0],f=c[1],p=Object(n.useCallback)((function(e){e.forEach((function(n){console.dir(e);var r=new FileReader;r.onabort=function(){return f("File reading was aborted")},r.onerror=function(){return f("File reading failed")},r.onload=function(){var e,n,c=r.result;!function(e){var a=window.localStorage.getItem(u);if(a){var t=JSON.parse(a),n=[].concat(Object(l.a)(t),Object(l.a)(e)),r=Object(l.a)(new Map(n.map((function(e){return[e.enteredTime,e]}))).values());d(u,r)}else d(u,e)}((e=function(e){var a=e.lastIndexOf('["instances"] = ')+17,t=e.slice(a),n=new RegExp(/, -- \[\d+\]/,"g"),r=t.replaceAll("\n","").replaceAll("\r","").replaceAll("\t","").replaceAll('["','"').replaceAll('"]','"').replaceAll(" = ",":").replaceAll(",}","}").split(n),c=[];return r.forEach((function(e,a){try{c.push(JSON.parse(e))}catch(t){}})),c}((n=c,null===n||"string"===typeof n?'{"error":true}':(new TextDecoder).decode(new Uint8Array(n)))),e.filter((function(e){return Object.keys(v).includes(String(e.instanceID))&&e.hasOwnProperty("purpleTeam")&&e.hasOwnProperty("goldTeam")})))),a(!t),f("File successfully parsed")},r.readAsArrayBuffer(n)}))}),[a,t]),b=Object(m.a)({onDrop:p}),h=b.getRootProps,j=b.getInputProps;return Object(M.jsxs)("div",Object(i.a)(Object(i.a)({},h()),{},{className:"upload-area",children:[Object(M.jsx)("input",Object(i.a)({},j())),Object(M.jsx)("p",{children:o})]}))},E=t(16),P=t.n(E),A=t(73),D=t.n(A);P.a.extend(D.a);var F=t(31),z=function(e){var a=e.sessionData,t=e.onChange,r={value:0,label:"All Data"},c=Object(n.useState)([]),o=Object(s.a)(c,2),i=o[0],m=o[1],u=Object(n.useRef)(i);u.current=i,Object(n.useEffect)((function(){if(i.length){var e=!0,t=Object(l.a)(a.keys());i.map((function(e){return e.value})).forEach((function(a){t.includes(a)||(e=!1)})),e||m([])}}),[i,a]);var d=Object(l.a)(a.keys()),f=[];d.forEach((function(e,a){var t=P.a.unix(e).format("HH:mm - DD/MM/YY"),n={value:e,label:"Session ".concat(a+1,", @ ").concat(t)};f.push(n)})),f.reverse();var p=function(){var e;return(null===u||void 0===u||null===(e=u.current)||void 0===e?void 0:e.length)===f.length};return Object(M.jsx)(F.a,{className:"session-select",classNamePrefix:"session-select",defaultValue:r,isOptionSelected:function(e){var a;return(null===u||void 0===u||null===(a=u.current)||void 0===a?void 0:a.some((function(a){return a.value===e.value})))||p()},options:[r].concat(f),value:p()?[r]:i,onChange:function(e,a){var n=[],c=a.action,o=a.option,s=a.removedValue;if("select-option"===c&&(null===o||void 0===o?void 0:o.value)===r.value)m(f),n.push.apply(n,Object(l.a)(f.map((function(e){return e.value}))));else if("deselect-option"===c&&(null===o||void 0===o?void 0:o.value)===r.value||"remove-value"===c&&(null===s||void 0===s?void 0:s.value)===r.value)m([]);else if("deselect-option"===a.action&&p()){var i=f.filter((function(e){return e.value!==(null===o||void 0===o?void 0:o.value)}));m(i),n.push.apply(n,Object(l.a)(i.map((function(e){return e.value}))))}else m(e||[]),n.push.apply(n,Object(l.a)(e.map((function(e){return e.value}))));t&&t(n)},hideSelectedOptions:!1,closeMenuOnSelect:!1,isMulti:!0})};var L=function(e){var a=e.teams,t=e.onChange,r=Object(n.useState)(),c=Object(s.a)(r,2),o=c[0],i=c[1],m=a.map((function(e){return{value:e,label:e}})),l=function(e){i(e),t&&e&&t(e.value)};return Object(n.useEffect)((function(){m.length&&!o&&i(m[0]),l(m[0])}),[a]),Object(M.jsx)(F.a,{className:"team-select",classNamePrefix:"team-select",options:m,value:o,onChange:l})},I=function(e){var a=e.buttonLabels,t=e.selected,n=e.onChange,r=a.map((function(e,a){var r=e===t;return Object(M.jsx)("button",{name:e,className:"button-group__button".concat(r?" button-group__button--selected":""),onClick:function(a){return function(e,a){n&&n(a)}(0,e)},children:e},a)}));return Object(M.jsx)("div",{className:"button-group",children:r})},W=t(30),_=t(210);function B(e,a,t){var n=t.colorStart,r=t.colorEnd;return t.useEndAsStart?r-e*a:n+e*a}function J(e,a,t,n){var r,c,o=t.colorStart,s=(t.colorEnd-o)/e;for(r=0;r<e;r++)c=B(r,s,t),n.push(a(c))}var H=function(e){var a,t,n=e.dataset,r=0,c=0,o=[],s=[],i=[],m=[],l=[],u=[],d={color:"#292F36",font:{size:15,family:"'Roboto', sans-serif"},stepSize:1,beginAtZero:!0},f={maintainAspectRatio:!1,indexAxis:"y",responsive:!0,scales:{y:{ticks:d},x:{ticks:d}},plugins:{tooltip:{callbacks:{afterLabel:function(e){var a=e.dataIndex,t=e.dataset.wins[a],n=e.dataset.data[a],r=e.dataset.zoneStats[a],c=e.dataset.performanceStats[a],o=R(n,t),s=[];Object.keys(r).forEach((function(e){s.push("".concat(v[Number(e)],": ").concat(R(r[e].matches,r[e].wins),"%"))}));var i=[];return Object.keys(c).forEach((function(e){var a=+(c[e].damage/n).toFixed(0),t=+(c[e].healing/n).toFixed(0).toLocaleString();i.push("".concat(e,": damage: ").concat(a.toLocaleString()," | healing: ").concat(t.toLocaleString()))})),["Wins: ".concat(t,", Losses: ").concat(n-t),"WR: ".concat(o,"%")," ","Zone win rates:"].concat(s,[" ","Average performance stats:"],i)}}},legend:{display:!1}}},p={labels:o,datasets:[{label:"",data:s,wins:i,zoneStats:m,performanceStats:l,backgroundColor:u,borderColor:[],borderWidth:1,hoverOffset:6}]},b=[];Object.keys(n).forEach((function(e){var a=n[e],t=a.matchCount,r=a.wins,c=a.zoneStats,o=a.performanceStats;b.push({teamComp:e,matchCount:t,wins:r,zoneStats:c,performanceStats:o})})),b.sort((function(e,a){return a.matchCount-e.matchCount})),b.forEach((function(e){var a=e.matchCount,t=e.wins,n=e.zoneStats,u=e.performanceStats,d=e.teamComp;r+=a,c+=t,o.push([d]),s.push(a),i.push(t),m.push(n),l.push(u)})),J(b.length,_.a,{colorStart:.1,colorEnd:.85,useEndAsStart:!0},u),a=r-c,t=R(r,c);var h="Matches Played: ".concat(r,", Wins: ").concat(c,", Losses: ").concat(a,", WR: ").concat(t,"%,");return Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)("div",{className:"header",children:Object(M.jsx)("h1",{className:"title",children:h})}),Object(M.jsx)("div",{className:"chart-container",children:Object(M.jsx)(W.a,{data:p,options:f})})]})},V=function(e){var a=e.dataset,t=[],n=[],r=[],c=[],o=[];a.sort((function(e,a){return e.timestamp-a.timestamp})),a.forEach((function(e,s){var i,m=e.enemyTeamComp,l=e.newTeamRating,u=e.win;t.push(l),r.push(m),c.push(String(s+1)),o.push(u);var d=null===(i=a[s+1])||void 0===i?void 0:i.teamMMR;d&&n.push(d)}));var s={color:"#292F36",font:{size:15,family:"'Roboto', sans-serif"},stepSize:1,beginAtZero:!0},m={maintainAspectRatio:!1,scales:{"y-axis-1":{ticks:Object(i.a)(Object(i.a)({},s),{},{autoSkip:!0,maxTicksLimit:15}),bounds:"ticks",grid:{borderDashOffset:.9}},x:{ticks:Object(i.a)(Object(i.a)({},s),{},{autoSkip:!0,maxTicksLimit:20})}},plugins:{tooltip:{callbacks:{afterLabel:function(e){var a=e.dataIndex,t=e.dataset.enemyComp[a],n=e.dataset.win[a];return[t,"".concat(n?"Win":"Loss")]}}}}},l={labels:c,datasets:[{label:"New Team Rating",data:t,enemyComp:r,win:o,fill:!1,backgroundColor:"rgb(254,38,0)",borderColor:"rgb(254,131,0)",yAxisID:"y-axis-1"},{label:"MMR",data:n,enemyComp:r,win:o,fill:!1,backgroundColor:"rgb(0,196,255)",borderColor:"rgb(0,255,255)",yAxisID:"y-axis-1"}]};return Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)("div",{className:"header",children:Object(M.jsx)("h1",{className:"title",children:"Team Rating Change"})}),Object(M.jsx)("div",{className:"chart-container",children:Object(M.jsx)(W.b,{data:l,options:m})})]})},Z=t(74),U=function(e){var a=e.dataset,t=[],n=[],r=[],c=[],o=[],s=[],i=[],m=[],l={color:"#292F36",font:{size:15,family:"'Roboto', sans-serif"},stepSize:1,beginAtZero:!0},u={maintainAspectRatio:!1,responsive:!0,scales:{y:{ticks:l},x:{ticks:l}},plugins:{tooltip:{callbacks:{afterLabel:function(e){var a=e.dataIndex,t=e.dataset,n=t.teamComp[a],r=t.teamMMR[a],c=t.teamRating[a],o=function(e){var a={names:[],realm:""};return e.forEach((function(e){var t=e.split("-");a.names.push(t[0]),a.realm=t[1]})),a}(t.enemyPlayerNames[a]),s=t.wins[a],i=e.dataset.data[a];return[n,"Wins: ".concat(s,", Losses: ").concat(i-s,", WR: ").concat(R(i,s),"%"),"Their MMR - min: ".concat(r.min," | max: ").concat(r.max," | avg: ").concat(r.average),"Their Rating - min: ".concat(c.min," | max: ").concat(c.max," | avg: ").concat(c.average),"Realm: ".concat(o.realm),"Names: ".concat(o.names)]}}},legend:{display:!1}}},d={labels:n,datasets:[{label:"",data:r,wins:c,teamComp:o,teamMMR:s,teamRating:i,enemyPlayerNames:m,backgroundColor:t,borderColor:[],borderWidth:1,hoverOffset:6}]},f=Object.values(a);f.sort((function(e,a){return a.matchesPlayed-e.matchesPlayed})),f.forEach((function(e){var a=e.teamName,t=e.matchesPlayed,l=e.wins,u=e.enemyTeamComp,d=e.teamRating,f=e.teamMMR,p=e.enemyPlayerNames;n.push(a),r.push(t),c.push(l),o.push(u),i.push(d),s.push(f),m.push(p)}));return J(f.length,_.a,{colorStart:.1,colorEnd:.85,useEndAsStart:!0},t),Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)("div",{className:"header",children:Object(M.jsx)("h1",{className:"title",children:"Enemy Team Stats"})}),Object(M.jsx)("div",{className:"chart-container",children:Object(M.jsx)(Z.Bar,{data:d,options:u})})]})},Y=function(e){var a=e.sessionData,t=e.sessionSelection,r=e.chartType,c=Object(n.useState)({}),o=Object(s.a)(c,2),i=o[0],m=o[1],u=Object(n.useState)(""),d=Object(s.a)(u,2),f=d[0],p=d[1];return Object(n.useEffect)((function(){var e=[];if(null===a||void 0===a?void 0:a.size)if(t.includes(0))e.push.apply(e,Object(l.a)(O(a)));else{var n=new Map;t.forEach((function(e){var t=a.get(e);t&&n.set(e,t)})),e.push.apply(e,Object(l.a)(O(n)))}switch(r){case y[0]:m(function(e){var a={};return e.forEach((function(e){if(e.enemyTeamComp.includes(b)||e.myTeamComp.includes(b))N(a,"DC",e);else{var t=S(e.enemyTeamComp);N(a,t,e)}})),a}(e));break;case y[1]:m(x(e));break;case y[2]:m(C(e))}p(r)}),[r,a,t]),Object(M.jsxs)("div",{className:"chart-wrapper",children:[f===y[0]&&Object(M.jsx)(H,{dataset:i}),f===y[1]&&Object(M.jsx)(V,{dataset:i}),f===y[2]&&Object(M.jsx)(U,{dataset:i})]})},q=function(){var e=Object(n.useState)([]),a=Object(s.a)(e,2),t=a[0],r=a[1],c=Object(n.useState)([""]),o=Object(s.a)(c,2),i=o[0],m=o[1],d=Object(n.useState)(""),f=Object(s.a)(d,2),p=f[0],b=f[1],h=Object(n.useState)(new Map),v=Object(s.a)(h,2),j=v[0],O=v[1],T=Object(n.useState)([0]),x=Object(s.a)(T,2),N=x[0],S=x[1],C=Object(n.useState)(y[0]),w=Object(s.a)(C,2),R=w[0],E=w[1],A=Object(n.useState)(!1),D=Object(s.a)(A,2),F=D[0],W=D[1];return Object(n.useEffect)((function(){var e,a=window.localStorage.getItem(u);if(a){var t=g(JSON.parse(a));r(t),m((e=t,Object(l.a)(new Set(e.map((function(e){return e.myTeamName}))))))}}),[F]),Object(n.useEffect)((function(){var e,a=(e=p,t.filter((function(a){return a.myTeamName===e})));O(function(e){var a=new Map;e.sort((function(e,a){return e.enteredTime-a.enteredTime}));var t,n=null;return e.every((function(e){if(n){var r,c=P.a.unix(t.enteredTime);if(P.a.unix(e.enteredTime).isBetween(c,c.add(1,"hour")))return null===(r=a.get(n))||void 0===r||r.push(e),t=e,!0}return n=e.enteredTime,t=e,a.set(n,[e]),!0})),a}(a)),S([0])}),[t,p]),Object(M.jsxs)("div",{className:"dashboard",children:[Object(M.jsxs)("div",{className:"dashboard__top-bar",children:[Object(M.jsx)(k,{localStoreChangeHandler:W,localStorageChangeValue:F}),Object(M.jsxs)("div",{className:"dashboard__filters",children:[Object(M.jsx)(I,{onChange:E,buttonLabels:y,selected:R}),i&&Object(M.jsx)(L,{onChange:b,teams:i}),j&&Object(M.jsx)(z,{onChange:S,sessionData:j})]})]}),t&&Object(M.jsx)(Y,{sessionData:j,sessionSelection:N,chartType:R})]})};var G=function(){return Object(M.jsx)("div",{className:"main-wrap",children:Object(M.jsx)(q,{})})},K=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,211)).then((function(a){var t=a.getCLS,n=a.getFID,r=a.getFCP,c=a.getLCP,o=a.getTTFB;t(e),n(e),r(e),c(e),o(e)}))};o.a.render(Object(M.jsx)(r.a.StrictMode,{children:Object(M.jsx)(G,{})}),document.getElementById("root")),K()},82:function(e,a,t){},83:function(e,a,t){}},[[209,1,2]]]);
//# sourceMappingURL=main.e96c7cf1.chunk.js.map